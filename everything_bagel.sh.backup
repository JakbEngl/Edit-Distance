#!/bin/bash


export LD_PRELOAD=/usr/local/lib/libjemalloc.so
alpha=256

printf "n, k, Parlay, HashB, Hash, BHB, BH, SAB, SA, DAC_MM\n"
hash=0
b_hash=1
sa=2
dacmmk=3
dacmm=4
dp=5
parlay=6


printf "\n\n\n\n############################### Synthetic DATA ###############################\n\n\n\n"


for n in 100000; do
    for k in 1 10 100 1000 10000; do
        printf "%d, %d, " ${n} ${k}
        numactl -i all ./test_framework 6 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 0 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 1 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 2 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 3 ${n} ${k} ${alpha}
        printf "\n"
    done
done

for n in 1000000; do
    for k in 1 10 100 1000; do
        printf "%d, %d, " ${n} ${k}
        numactl -i all ./test_framework 6 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 0 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 1 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 2 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 3 ${n} ${k} ${alpha}
        printf "\n"
    done
done

for n in 1000000; do
    for k in 10000 100000; do
        printf "%d, %d, NA " ${n} ${k}
        # numactl -i all ./test_framework 6 ${n} ${k} ${alpha}
        # printf ","
        numactl -i all ./test_framework 0 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 1 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 2 ${n} ${k} ${alpha}
        printf ","
        # numactl -i all ./test_framework 3 ${n} ${k} ${alpha}
        printf "NA\n"
    done
done

for n in 10000000; do
    for k in 1 10 100; do
        printf "%d, %d, NA, " ${n} ${k}
        numactl -i all ./test_framework 0 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 1 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 2 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 3 ${n} ${k} ${alpha}
        printf "\n"
    done
done

for n in 10000000; do
    for k in 1000 10000 100000; do
        printf "%d, %d, NA, " ${n} ${k}
        numactl -i all ./test_framework 0 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 1 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 2 ${n} ${k} ${alpha}
        printf ","
        # numactl -i all ./test_framework 3 ${n} ${k} ${alpha}
        printf "NA\n"
    done
done

for n in 100000000; do
    for k in 1 10; do
        printf "%d, %d, NA" ${n} ${k}
        numactl -i all ./test_framework 0 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 1 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 2 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 3 ${n} ${k} ${alpha}
        printf "\n"
    done
done

for n in 100000000; do
    for k in 100 1000 10000 100000; do
        printf "%d, %d, NA" ${n} ${k}
        numactl -i all ./test_framework 0 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 1 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 2 ${n} ${k} ${alpha}
        printf ", NA"
        # numactl -i all ./test_framework 3 ${n} ${k} ${alpha}
        printf "\n"
    done
done

for n in 1000000000; do
    for k in 1; do
        printf "%d, %d, NA" ${n} ${k}
        numactl -i all ./test_framework 0 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 1 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 2 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 3 ${n} ${k} ${alpha}
        printf "\n"
    done
done

for n in 1000000000; do
    for k in 10 100 1000 10000 10000 100000; do
        printf "%d, %d, NA" ${n} ${k}
        numactl -i all ./test_framework 0 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 1 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 2 ${n} ${k} ${alpha}
        printf ",NA"
        # numactl -i all ./test_framework 3 ${n} ${k} ${alpha}
        printf "\n"
    done
done


############################### REAL DATA ###############################

printf "\n\n\n\n############################### REAL DATA ###############################\n\n\n\n"


## wiki
printf "#################### \n"
printf "Wikipedia \n"
printf "#################### \n"
printf "misconceptions \n\n"
printf "parlay\n\n"
numactl -i all ./test_framework_real 6 -f1 ./../datasets/compare_sets/misconceptions.1.txt -f2 ./../datasets/compare_sets/misconceptions.2.txt
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/misconceptions.1.txt -f2 ./../datasets/compare_sets/misconceptions.2.txt
printf "\n Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/misconceptions.1.txt -f2 ./../datasets/compare_sets/misconceptions.2.txt
printf "SA \n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/misconceptions.1.txt -f2 ./../datasets/compare_sets/misconceptions.2.txt
printf "DAC_MM \n\n"
numactl -i all ./test_framework_real 3 -f1 ./../datasets/compare_sets/misconceptions.1.txt -f2 ./../datasets/compare_sets/misconceptions.2.txt

printf "\n firefox \n"
printf "parlay\n\n"
numactl -i all ./test_framework_real 6 -f1 ./../datasets/compare_sets/firefox.1.txt -f2 ./../datasets/compare_sets/firefox.2.txt
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/firefox.1.txt -f2 ./../datasets/compare_sets/firefox.2.txt
printf "Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/firefox.1.txt -f2 ./../datasets/compare_sets/firefox.2.txt
printf "SA \n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/firefox.1.txt -f2 ./../datasets/compare_sets/firefox.2.txt

printf "\n Science \n"
printf "parlay\n\n"
numactl -i all ./test_framework_real 6 -f1 ./../datasets/compare_sets/science2022.1.txt -f2 ./../datasets/compare_sets/science2022.2.txt
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/science2022.1.txt -f2 ./../datasets/compare_sets/science2022.2.txt
printf "Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/science2022.1.txt -f2 ./../datasets/compare_sets/science2022.2.txt
printf "SA \n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/science2022.1.txt -f2 ./../datasets/compare_sets/science2022.2.txt

printf "\n Quebec1 \n"
printf "parlay\n\n"
numactl -i all ./test_framework_real 6 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.2.txt
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.2.txt
printf "Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.2.txt
printf "SA \n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.2.txt
printf "DAC_MM \n\n"
numactl -i all ./test_framework_real 3 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.2.txt

printf "\n Quebec2 \n"
printf "parlay\n\n"
numactl -i all ./test_framework_real 6 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.3.txt
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.3.txt
printf "Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.3.txt
printf "SA \n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.3.txt

printf "\n Quebec3 \n"
printf "parlay\n\n"
numactl -i all ./test_framework_real 6 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.4.txt
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.4.txt
printf "Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.4.txt
printf "SA \n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/Quebec.1.txt -f2 ./../datasets/compare_sets/Quebec.4.txt

printf "\n\n #################### \n"
printf "Git \n"
printf "#################### \n"
printf "\n Git1 \n"
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.2.txt
printf "Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.2.txt
printf "SA\n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.2.txt
printf "DAC\n\n"
numactl -i all ./test_framework_real 3 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.2.txt


printf "\n Git2 \n"
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.3.txt
printf "Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.3.txt
printf "SA\n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.3.txt

printf "\n Git3 \n"
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.4.txt
printf "Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.4.txt
printf "SA\n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.4.txt

printf "\n Git4 \n"
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.5.txt
printf "Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.5.txt
printf "SA\n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/linux.1.txt -f2 ./../datasets/compare_sets/linux.5.txt

printf "\n\n #################### \n"
printf "DNA \n"
printf "#################### \n"
printf "\n DNA1 \n"
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/dna.modified.0.txt -f2 ./../datasets/compare_sets/dna.modified.1.txt
printf "Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/dna.modified.0.txt -f2 ./../datasets/compare_sets/dna.modified.1.txt
printf "SA\n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/dna.modified.0.txt -f2 ./../datasets/compare_sets/dna.modified.1.txt
# printf "DAC_MM\n\n"
# numactl -i all ./test_framework_real 3 -f1 ./../datasets/compare_sets/dna.modified.0.txt -f2 ./../datasets/compare_sets/dna.modified.1.txt

printf "\n DNA2\n"
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/dna.modified.0.txt -f2 ./../datasets/compare_sets/dna.modified.2.txt
printf "Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/dna.modified.0.txt -f2 ./../datasets/compare_sets/dna.modified.2.txt
printf "SA\n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/dna.modified.0.txt -f2 ./../datasets/compare_sets/dna.modified.2.txt

printf "\n DNA3\n"
printf "Hash\n\n"
numactl -i all ./test_framework_real 0 -f1 ./../datasets/compare_sets/dna.modified.0.txt -f2 ./../datasets/compare_sets/dna.modified.3.txt
printf "Block Hash\n\n"
numactl -i all ./test_framework_real 1 -f1 ./../datasets/compare_sets/dna.modified.0.txt -f2 ./../datasets/compare_sets/dna.modified.3.txt
printf "SA\n\n"
numactl -i all ./test_framework_real 2 -f1 ./../datasets/compare_sets/dna.modified.0.txt -f2 ./../datasets/compare_sets/dna.modified.3.txt




################################# SEQUENTIAL #######################################

printf "\n\n\n\n ################################# SEQUENTIAL ####################################### \n\n\n\n\n\n"


make SERIAL=1 -B

for n in 100000000; do
    for k in 10; do
        printf "%d, %d, NA" ${n} ${k}
        numactl -i all ./test_framework 0 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 1 ${n} ${k} ${alpha}
        printf ","
        # numactl -i all ./test_framework 2 ${n} ${k} ${alpha}
        # printf ",NA"
        # numactl -i all ./test_framework 3 ${n} ${k} ${alpha}
        printf "\n"
    done
done

for n in 1000000000; do
    for k in 10000 100000; do
        printf "%d, %d, NA" ${n} ${k}
        numactl -i all ./test_framework 0 ${n} ${k} ${alpha}
        printf ","
        numactl -i all ./test_framework 1 ${n} ${k} ${alpha}
        printf ","
        # numactl -i all ./test_framework 2 ${n} ${k} ${alpha}
        # printf ",NA"
        # numactl -i all ./test_framework 3 ${n} ${k} ${alpha}
        printf "\n"
    done
done